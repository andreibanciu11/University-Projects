INSERT INTO Labels 
VALUES (2, 'Def Jam', 'USA', 'New York', '1984-01-01', 'rap');
INSERT INTO Labels 
VALUES (3, 'Young Money', 'USA', 'New Orleans', '2005-01-01', 'rap');
INSERT INTO Labels 
VALUES (4, 'Jive', 'USA', 'New York', '1981-01-01', 'rap');
INSERT INTO Labels 
VALUES (5, 'Shady', 'USA', 'Detroit', '1999-01-01', 'rap');

INSERT INTO Artists
VALUES (1, 'Drake', 'Canada', '1986-10-24', 1846597930, 1);
INSERT INTO Artists
VALUES (2, 'Snoop Dog', 'USA', '1971-10-20', 165499635, 2);
INSERT INTO Artists
VALUES (3, 'Kanye West', 'USA', '1977-06-08', 337102952, 3);
INSERT INTO Artists
VALUES (4, '2Pac', 'USA', '1971-06-16', 10710555, 4);
INSERT INTO Artists
VALUES (5, 'Eminem', 'USA', '1972-10-17', 744519259, 5);
INSERT INTO Artists
VALUES (6, 'Lil Tjay', 'USA', '2001-04-30', 846597930, 1);
INSERT INTO Artists
VALUES (7, 'Young Thug', 'USA', '1991-08-16', 642901578, 2);
INSERT INTO Artists
VALUES (8, 'Gunna', 'USA', '1993-06-14', 1707412952, 3);
INSERT INTO Artists
VALUES (9, 'Jack Harlow', 'USA', '1998-03-13', 1976814508, 4);
INSERT INTO Artists
VALUES (10, '21 Savage', 'USA', '1992-10-22', 123419259, 5);

INSERT INTO Producers
VALUES (1, 'DJ Premier', 'USA', '1966-03-21');
INSERT INTO Producers
VALUES (2, 'Dr. Dre', 'USA', '1965-02-18');
INSERT INTO Producers
VALUES (3, 'Kanye West', 'USA', '1977-06-08');
INSERT INTO Producers
VALUES (4, 'Johnny J', 'USA', '1969-08-28');
INSERT INTO Producers
VALUES (5, 'Rick Rubin', 'USA', '1963-03-10');

INSERT INTO Songs 
VALUES (1, 'One Dance', '2016-04-12', 1);
INSERT INTO Songs 
VALUES (2, 'Young, Wild & Free', '2011-10-11', 2);
INSERT INTO Songs 
VALUES (3, 'I Love It', '2018-09-13', 3);
INSERT INTO Songs 
VALUES (4, 'California Love', '1995-12-03', 4);
INSERT INTO Songs 
VALUES (5, 'Godzilla', '2020-01-23', 5);
INSERT INTO Songs 
VALUES (6, 'Forever', '2009-08-27', 1);
INSERT INTO Songs 
VALUES (7, 'Eyes Closed', '2011-03-29', 2);
INSERT INTO Songs 
VALUES (8, 'From the D 2 the LBC', '2022-06-24', 2);
INSERT INTO Songs 
VALUES (9, 'Use this gospel', '2022-08-22', 3);
INSERT INTO Songs 
VALUES (10, 'All Eyez On Me', '1996-02-13', 4);

INSERT INTO Performing
VALUES (1, 1, 1);
INSERT INTO Performing
VALUES (2, 2, 1);
INSERT INTO Performing
VALUES (3, 3, 1);
INSERT INTO Performing
VALUES (4, 4, 1);
INSERT INTO Performing
VALUES (5, 5, 0);
INSERT INTO Performing
VALUES (1, 6, 1);
INSERT INTO Performing
VALUES (3, 6, 1);
INSERT INTO Performing
VALUES (5, 6, 1);
INSERT INTO Performing
VALUES (2, 7, 1);
INSERT INTO Performing
VALUES (3, 7, 1);
INSERT INTO Performing
VALUES (2, 8, 1);
INSERT INTO Performing
VALUES (5, 8, 1);
INSERT INTO Performing
VALUES (3, 9, 1);
INSERT INTO Performing
VALUES (5, 9, 1);
INSERT INTO Performing
VALUES (4, 10, 0);

INSERT INTO Concerts
VALUES (1, 'Rolling Loud', '2022-12-10', 'USA', 'Los Angeles', 1);
INSERT INTO Concerts
VALUES (2, 'JMBLYA', '2023-05-15', 'USA', 'Texas', 2);
INSERT INTO Concerts
VALUES (3, 'Tycoon', '2023-06-08', 'USA', 'Atlanta', 3);
INSERT INTO Concerts
VALUES (4, 'House of Blues', '1996-07-04', 'USA', 'Los Angeles', 4);
INSERT INTO Concerts
VALUES (5, 'Broccoli City', '2023-04-21', 'USA', 'Washington', 5);
INSERT INTO Concerts
VALUES (6, 'Soundset', '2023-05-05', 'USA', 'Minneapolis', 6);
INSERT INTO Concerts
VALUES (7, 'Something in the water', '2023-04-25', 'USA', 'Virginia', 7);
INSERT INTO Concerts
VALUES (8, 'Greatest day ever', '2023-07-14', 'USA', 'Coney Island', 8);
INSERT INTO Concerts
VALUES (9, 'Neon Desert', '2023-08-24', 'USA', 'Texas', 9);
INSERT INTO Concerts
VALUES (10, 'Head In The Clouds', '2023-10-04', 'USA', 'Los Angeles', 10);
INSERT INTO Concerts
VALUES (11, 'Come Closer', '2019-04-13', 'United Kingdom', 'London', 1);
INSERT INTO Concerts
VALUES (12, 'Super Bowl HALFTIME SHOW', '2022-02-13', 'USA', 'Inglewood', 2);
INSERT INTO Concerts
VALUES (13, 'Paradise', '2016-04-10', 'Philippines', 'Paranaque', 3);
INSERT INTO Concerts
VALUES (14, 'Thug Life Code Fundraiser', '1993-05-25', 'USA', 'Oklahoma', 4);
INSERT INTO Concerts
VALUES (15, 'Nowhere Fast', '2018-11-07', 'USA', 'Pittsburgh', 5);

INSERT INTO Platforms
VALUES (1, 'Spotify', 422000000);
INSERT INTO Platforms
VALUES (2, 'Apple Music', 88000000);
INSERT INTO Platforms
VALUES (3, 'Youtube', 1900000000);
INSERT INTO Platforms
VALUES (4, 'SoundCloud', 76000000);
INSERT INTO Platforms
VALUES (5, 'Tidal', 5000000);

INSERT INTO PlayingPlatform
VALUES (1, 1);
INSERT INTO PlayingPlatform
VALUES (1, 2);
INSERT INTO PlayingPlatform
VALUES (1, 3);
INSERT INTO PlayingPlatform
VALUES (1, 4);
INSERT INTO PlayingPlatform
VALUES (1, 5);
INSERT INTO PlayingPlatform
VALUES (1, 6);
INSERT INTO PlayingPlatform
VALUES (1, 7);
INSERT INTO PlayingPlatform
VALUES (1, 8);
INSERT INTO PlayingPlatform
VALUES (1, 9);
INSERT INTO PlayingPlatform
VALUES (1, 10);
INSERT INTO PlayingPlatform
VALUES (2, 1);
INSERT INTO PlayingPlatform
VALUES (2, 2);
INSERT INTO PlayingPlatform
VALUES (2, 3);
INSERT INTO PlayingPlatform
VALUES (2, 4);
INSERT INTO PlayingPlatform
VALUES (2, 5);
INSERT INTO PlayingPlatform
VALUES (2, 6);
INSERT INTO PlayingPlatform
VALUES (2, 7);
INSERT INTO PlayingPlatform
VALUES (2, 8);
INSERT INTO PlayingPlatform
VALUES (2, 9);
INSERT INTO PlayingPlatform
VALUES (2, 10);
INSERT INTO PlayingPlatform
VALUES (3, 1);
INSERT INTO PlayingPlatform
VALUES (3, 2);
INSERT INTO PlayingPlatform
VALUES (3, 3);
INSERT INTO PlayingPlatform
VALUES (3, 4);
INSERT INTO PlayingPlatform
VALUES (3, 5);
INSERT INTO PlayingPlatform
VALUES (3, 6);
INSERT INTO PlayingPlatform
VALUES (3, 7);
INSERT INTO PlayingPlatform
VALUES (3, 8);
INSERT INTO PlayingPlatform
VALUES (3, 9);
INSERT INTO PlayingPlatform
VALUES (3, 10);
INSERT INTO PlayingPlatform
VALUES (4, 1);
INSERT INTO PlayingPlatform
VALUES (4, 2);
INSERT INTO PlayingPlatform
VALUES (4, 3);
INSERT INTO PlayingPlatform
VALUES (4, 7);
INSERT INTO PlayingPlatform
VALUES (4, 8);
INSERT INTO PlayingPlatform
VALUES (4, 9);
INSERT INTO PlayingPlatform
VALUES (5, 5);
INSERT INTO PlayingPlatform
VALUES (5, 6);
INSERT INTO PlayingPlatform
VALUES (5, 7);

INSERT INTO Radio
VALUES (1, 'Hot 97', 1500000);
INSERT INTO Radio
VALUES (2, 'Power 105.1', 1220000);
INSERT INTO Radio
VALUES (3, 'Streetz 94.5', 900000);
INSERT INTO Radio
VALUES (4, 'KBXX 97.9', 875000);
INSERT INTO Radio
VALUES (5, 'Wild 94.9', 630000);

INSERT INTO PlayingRadio
VALUES (1, 1);
INSERT INTO PlayingRadio
VALUES (1, 2);
INSERT INTO PlayingRadio
VALUES (1, 3);
INSERT INTO PlayingRadio
VALUES (1, 4);
INSERT INTO PlayingRadio
VALUES (1, 5);
INSERT INTO PlayingRadio
VALUES (1, 6);
INSERT INTO PlayingRadio
VALUES (1, 7);
INSERT INTO PlayingRadio
VALUES (1, 8);
INSERT INTO PlayingRadio
VALUES (1, 9);
INSERT INTO PlayingRadio
VALUES (1, 10);
INSERT INTO PlayingRadio
VALUES (2, 1);
INSERT INTO PlayingRadio
VALUES (2, 2);
INSERT INTO PlayingRadio
VALUES (2, 3);
INSERT INTO PlayingRadio
VALUES (2, 4);
INSERT INTO PlayingRadio
VALUES (2, 5);
INSERT INTO PlayingRadio
VALUES (2, 7);
INSERT INTO PlayingRadio
VALUES (2, 8);
INSERT INTO PlayingRadio
VALUES (2, 9);
INSERT INTO PlayingRadio
VALUES (2, 10);
INSERT INTO PlayingRadio
VALUES (3, 1);
INSERT INTO PlayingRadio
VALUES (3, 2);
INSERT INTO PlayingRadio
VALUES (3, 3);
INSERT INTO PlayingRadio
VALUES (3, 5);
INSERT INTO PlayingRadio
VALUES (3, 6);
INSERT INTO PlayingRadio
VALUES (3, 7);
INSERT INTO PlayingRadio
VALUES (3, 9);
INSERT INTO PlayingRadio
VALUES (3, 10);
INSERT INTO PlayingRadio
VALUES (4, 1);
INSERT INTO PlayingRadio
VALUES (4, 4);
INSERT INTO PlayingRadio
VALUES (4, 5);
INSERT INTO PlayingRadio
VALUES (4, 6);
INSERT INTO PlayingRadio
VALUES (4, 7);
INSERT INTO PlayingRadio
VALUES (5, 1);
INSERT INTO PlayingRadio
VALUES (5, 3);
INSERT INTO PlayingRadio
VALUES (5, 5);
INSERT INTO PlayingRadio
VALUES (5, 7);
INSERT INTO PlayingRadio
VALUES (5, 8);
INSERT INTO PlayingRadio
VALUES (5, 10);

UPDATE Performing
SET Featuring = 1
WHERE ArtistID = 4 AND Featuring = 0;

UPDATE PlayingPlatform
SET SongID = 10
WHERE (PlatformID = 4 OR PlatformID = 5) AND SongID = 7;

UPDATE PlayingRadio
SET SongID = 9
WHERE RadioID IN (4, 5) AND SongID = 7;

--====

DELETE FROM PlayingPlatform
WHERE (PlatformID BETWEEN 3 AND 5) AND SongID >= 9;

DELETE FROM Concerts
WHERE Country LIKE 'U%' AND ConcertDate > '2023-10-01';

--a)
SELECT Title
FROM Songs
WHERE SongID IN (SELECT SongID FROM Performing WHERE ArtistID = 1)
UNION
SELECT TOP 1 ConcertName 
FROM Concerts
WHERE SignedArtistID = 1;

--===

SELECT LabelName
FROM Labels
WHERE LabelID = 1
UNION
SELECT ArtistName
FROM Artists
WHERE SignedLabelID = 1 AND NumberOfStreams > 1000000000;

--b)
SELECT ArtistName
FROM Artists
INTERSECT
SELECT ProducerName
FROM Producers;

--===

SELECT Title
FROM Songs
WHERE SongID IN (SELECT SongID FROM PlayingPlatform WHERE PlatformID = 3 INTERSECT SELECT SongID FROM PlayingRadio WHERE RadioID = 3);

--c)
DECLARE @string1 AS VARCHAR(50);
DECLARE @string2 AS VARCHAR(50);

SET @string1 = (SELECT TOP 1 ConcertName 
FROM Concerts
WHERE ConcertID IN (SELECT ConcertID
FROM Concerts
EXCEPT
SELECT ConcertID
FROM Concerts
WHERE Country = 'USA'));

SET @string2 = (SELECT TOP 1 ConcertName
FROM Concerts);

SELECT DIFFERENCE(@string1, @string2);

--====

DECLARE @string3 AS VARCHAR(50);
DECLARE @string4 AS VARCHAR(50);

SET @string3 = (SELECT ArtistName
FROM Artists
WHERE ArtistID = (SELECT TOP 1 ArtistID FROM Artists WHERE ArtistID NOT IN (SELECT DISTINCT SignedArtistID FROM Concerts)));

SET @string4 = (SELECT ArtistName
FROM Artists
WHERE ArtistID = (SELECT TOP 1 ArtistID FROM Performing WHERE SongID NOT IN (SELECT SongID FROM PlayingRadio WHERE RadioID = 4)));

SELECT DIFFERENCE(@string3, @string4);

--d)
SELECT Labels.LabelName, Artists.ArtistName, Concerts.ConcertName
FROM ((Labels
INNER JOIN Artists ON Labels.LabelID = Artists.SignedLabelID)
INNER JOIN Concerts ON Artists.ArtistID = Concerts.SignedArtistID)
ORDER BY Labels.LabelName;

--====

--***
SELECT Performing.ArtistID, Performing.SongID, PlayingPlatform.PlatformID
FROM Performing
LEFT JOIN PlayingPlatform
ON PlayingPlatform.SongID = Performing.SongID;
--***

SELECT Artists.ArtistName, Songs.Title, Platforms.PlatformName
FROM (((((Artists
LEFT JOIN Performing ON Artists.ArtistID = Performing.ArtistID)
LEFT JOIN Songs ON Songs.SongID = Performing.SongID)
LEFT JOIN PlayingPlatform ON PlayingPlatform.SongID = Songs.SongID)
LEFT JOIN Platforms ON Platforms.PlatformID = PlayingPlatform.PlatformID)
)
WHERE Songs.Title IS NOT NULL AND Platforms.PlatformName IS NOT NULL;

--===

SELECT Producers.ProducerName, Songs.Title, Songs.DateOfRelease
FROM Songs
RIGHT JOIN Producers ON Songs.SignedProducerID = Producers.ProducerID;

--===

SELECT Songs.Title, Songs.DateOfRelease, Platforms.PlatformName
FROM ((Songs
FULL JOIN PlayingPlatform ON Songs.SongID = PlayingPlatform.SongID)
FULL JOIN Platforms ON PlayingPlatform.PlatformID = Platforms.PlatformID);

--e)
SELECT ConcertName
FROM Concerts
WHERE SignedArtistID IN (SELECT ArtistID FROM Artists WHERE DOB >= '1985-01-01');

--===

SELECT RadioName
FROM Radio
WHERE RadioFMID IN (SELECT RadioID FROM PlayingRadio WHERE SongID IN (SELECT SongID FROM Songs WHERE SignedProducerID = 2));

--f)
SELECT ConcertName
FROM Concerts
WHERE EXISTS (SELECT ArtistName FROM Artists WHERE Artists.ArtistID = Concerts.SignedArtistID AND Concerts.ConcertDate >= '2023-01-01');

--====

SELECT ArtistName
FROM Artists
WHERE EXISTS (SELECT LabelName FROM Labels WHERE Labels.LabelID = Artists.ArtistID AND Labels.DateOfEstablishment >= '2000-01-01');

--g)
SELECT Country
FROM (SELECT ConcertName, Country FROM Concerts WHERE SignedArtistID BETWEEN 1 AND 3) AS Table1
WHERE Country != 'USA';

--====

SELECT DISTINCT PN
FROM (SELECT Songs.Title, Platforms.PlatformName AS PN FROM PlayingPlatform, Platforms, Songs WHERE Songs.SongID = PlayingPlatform.SongID AND PlayingPlatform.PlatformID = Platforms.PlatformID AND Songs.SongID = 8) AS Table1;

--h)
SELECT PlatformID, COUNT(SongID)
FROM PlayingPlatform
GROUP BY PlatformID HAVING COUNT(SongID) > 7;

--====

SELECT ArtistID, COUNT(SongID)
FROM Performing
GROUP BY Performing.ArtistID HAVING COUNT(SongID) = (SELECT MAX(alias) FROM (SELECT COUNT(SongID) as alias FROM Performing GROUP BY ArtistID) AS table1);

--====

SELECT SignedProducerID, COUNT(SongID)
FROM Songs
GROUP BY SignedProducerID;

--====


--====

--i)
SELECT ArtistName
FROM Artists
WHERE Country = ANY
(SELECT Country
FROM Labels
WHERE City='New York');

--====

SELECT Title
FROM Songs
WHERE SignedProducerID = ANY
(SELECT ProducerID
FROM Producers
WHERE DOB = (SELECT MAX(alias) FROM (SELECT DOB as alias FROM Producers) as table1)
);

--====

SELECT PlatformName
FROM Platforms
WHERE NumberOfUsers > ALL
(SELECT NumberOfUsers
FROM Radio
WHERE NumberOfUsers > (SELECT MAX(alias) FROM (SELECT NumberOfUsers AS alias FROM Radio) AS Table1)
);

--====

SELECT ConcertName 
FROM Concerts
WHERE Country = ALL
(SELECT Country
FROM Artists
WHERE ArtistName = 'Drake'
);

--====